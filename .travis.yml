sudo: required
dist: trusty
services:
- docker
env:
  global:
  - PATH=$HOME/.local/bin:$PATH
  - PKGFORGE_STATEFILE=/tmp/pkgforge
  - BUCKET=akerl-relay
  - secure: LIsak5rP76CP0nU3SrIcHSznnezmS0dYNDno8imWmmk3ARa+hcCYvYNQeGTu6LXlDmsw7Czw7VgiVrTeRiowD5w1VO3JulreJWUrDjT0iyrOKMtK7jGXJepEJEFSoP9BGDNiM21GOLBAPboq1Tja0QDM1cv6XX8kcMgdT91j3I99zMnvAzqtymMO4VAvnn/Msza8K5QbQ10vuXeP1dHS0CpO+fq1/8tFCIVcwOSZkoUK+eHptoV2CoE47CuKJUulSR4UNYGJw7BtOjwrDf2imVFpqgmgRcS8AbwDSXq+o6YTwhRZRX6Qnnc6LTDpiHq6B+8iyrz8TEbT4+mv/QuO814zXrURkLHfQD4V7LqESdz4Wo0XhZ9PxNSxoZTyVg3qYnSeKBjLPtwoaFLaJknhlzL/5XPE3YdE2sDNFrFZvU9omNskzXsBdE45uAuoV0rCwQBfghfeafjge5sgvSxsJca3VMFPXAys2St9NPkTb8e6VseuZZTOvvgGqAMULMODFOOCVmgkC8WA5nEhr4q2IwN3gjjopo2MmbY1akKQCqm4e/sVd/QPveTtPOE3VBu+doXexhiFJTOK62GbSWzPDzKB9DKUKSpcWVEET7NoWGkYhpDVCjGZMaun7jQVj6k2K4hCYXU/iwLle3T1u4BxnDaG4zW/NeS7jcNXHRvGo+A=
  - secure: MTwdTStu5Kh0U6QTe5G0+cEfOkgPBxFdjPjmIOIeGloSCypNJ941KUEISC0+2JmimeBU9ciQBnu52QXOtMu/w7nllytXO7npXwCfZSBZ9Jh4g4avSl1v+GLn8mJgu4b6Qm7WJcOywgYfSJzIHiyikEaX6tNooqSzWomGsK5l2joszasCTAqcbrJH922FsLj/KmBjlZ4QRX+MswWupmtiYgEtfMgnuFNBKYyeRKY41YLeLoDElGnb5h8MInizezKBHRDQJtnKtH0tpBFzjQ6mDr/X35Ps7//YYyffhNCBaz8VhX9ccz+4xl34KuK7hh5tctOO6q16rhhLE706R6rij8uKgX9qxHZ5jMUrXCvQJegoJIjnwLuKX0j11Aganit0QeHxN9ePwDXlROH1BCL9nqDt6Zk/nhqMIKABwpUU9LZR7ZydJSOBYkAH19wCC1Bj6esMkTeH+lkRYdl84VxWsCqltgabewrOa0rw+ylLD6olFJTEeKPYCCFp7zxBHnuDeRgbDSaId1nddlAje1BFezKRI9pteFR5oNi8GhgHRV90oVDtUYcCffP/Dzsvd1klGvB5H5l12CpKJXWO6pXRCFPiqKzqwz/TXl2qDR8ztDi1kmR61wmaznW8Xr/Tfmi4bUb+2jS/RgxyG3lQ1A4/SMFY3uq/YZBJtkaAshUimMw=
  - secure: QCtrNcBdezXtrzTdKGBEbx3XBx3tMKKH8+c5ho53DYWzxT4dZldLgd/Q5uR0hauv0vZuJz20AyWqbdxl2AJ5JyEXF9Do468TA3wcEk3bKvJv76odfjA6CIm2N+o1AqtcAaLE8YbkGFkhpEXN0GwxGw+c1vPPov419PLz1FMpl03mybO/AeP5DdBiEgZtHdKOUkcIRsr0ejdk9a6etmU2OApYcUSVDW7WduNaQKYC2XtT3L5x1lPEyNnJy6JL3hJQqZr+dsu3PXsAwjv0ET+FQo3kfi+DXX2AUKjhTviDA2Ui/On5KpYJCSvOg/5T3YPSag0cApWSF2Gsr1HDLn65O6/Ujhz2N1H1PjJ8qm36w0tshj/VGxcoRLUR+sKmVVfZCG1fvuJ9gQ5yyh4qr2NHjiX/sF3Pcaa3Fx1oazwblZJlVdNZBZhTupZol1LwxlGEQHWOBSmFX6ryiEqZjN0yEAymhFGYIBMtG5WtTanhGpwGFlFBWwHKHYBrIbvQhPZDnk6hD3mLeKdLVAPmjT9bsPT9QxKddCI6g0J4KAbGEASGnhQIMnHFYAo0Os+sx/Y9Nt0wHg6YiI0zbdL4yYu4u+3MgZLDtFOHLBs1B+QYkSaaC8o79LdDdxzq9McLUCQ62fi3QEtDbnkMjPvpeAi2/b/NSlgAFRL3i+DjOL5/ZXc=
before_install:
- pip install --user awscli
script: make
deploy:
  provider: script
  script: make release && aws s3 cp pkg/payload.zip "s3://$BUCKET/lambdas/payload-$TRAVIS_TAG.zip"
  skip_cleanup: true
  on:
    tags: true
notifications:
  email: false
  slack:
    secure: H22AQ7nSFoi6cO6xd4tftS2acKMAWzD75HWxhKSi4o77NZVbH7174MaAfgRKc0ZuhaiDo3EIisS6pym0ifPVlzle6e3k6gRLCBQdASLO9gZl6CDMV1ICIJa131bQyoVT3cKJxZA4JLi9lYuZLwYT1w3WEZ0nAYA8Be/y+UQzLzmIrbYHkmFtN6MYzn4TLJehW+fPmkspozk4sv2vuDA85t3S6YW7PxLFKDwxz5xvEFp+klZRDhif3iViD5GEhfhhPvAsxiu9Z7puOS0HyAeNI82OI8vTRA6HaBmlshTdc572vD8RnbpukIuQOeyO70ppoSVUZhyJWG4VvImikCvNa3yFLBltGTPCq/oaLufD2Z9bHKhU2fDR1fPBQKsWlqib9sbuig0numDRsd3EUTvXFruZY5G2FDNBpASvUvnW0UWlFt+LeTEofykh/QEHGWjnGsDMPSjoHJq5WWHg2oBAQF+SCpLSTHSWkEYuCKQto4cb1GEXHcFsC8aryhnZZQnflO9r88pHvOhrZ+m4LRqOnpS7UTwnhwL6iyYle63fw744zxvQwVloLYqIhBFmvMDaU6EYlJs0KNySJ4P+tui5lKZ1/ajkU30JzxrEdtW6mhfqKZ29GZLmLnUcCF23xsOCd0eZLvPCjYJwUMxt+WWF624Ggay0XbMA1yVX7kOoT+M=
